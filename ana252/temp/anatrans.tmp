#-------------------------------------------------------------------------------
#  generated by ANA 2.60
#  Thu Oct 20 00:57:47 2022
/* BEGIN_PROLOG */
FROM "ANA1.x_KompLib." "asprung"
#   Anregung - Sprungfunktion    Parameter:           (c) IERT  26.09.1995
#  y ^                           A  .. Amplitude y(t >= T)
#    |                           T  .. Sprungzeitpunkt
#    |        +-------- A        A0 .. Amplitude y(t < T)
#    |        |
#    |        |                  Hinweis:
#    | A0 ----+                  Der links- und rechtsseitige Grenzwert
#   -+----------------------->   der Amplitude wird aufgezeichnet.
#    0        T            t
#
BLOCK ASprung;
$ BLOCKDIM -1 -1 6 5
$ TEXT "Sprung"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
OUTPUT
   y "[1] Sprungausgang";
PARAMETER
   A = 1 "[1] Amplitude y(t >= T)";
   T = 0 "[s] Sprungzeitpunkt";
   A0 = 0 "[1] Amplitude y(t < T)";
VAR
   a DISCRETE "Amplitude";
SIM
   y = a <- stepon;
ENDSIM

PROCEDURE stepon;
   a = A;
   STORE ALL;
ENDPROCEDURE

INIT
   IF T < 0 THEN
      EXIT "Schaltzeitpunkt T muss >= 0 sein";
   ENDIF
   SCHEDULE stepon AT T;
   a = A0;
ENDINIT
ENDBLOCK ASprung;

FROM "ANA1.x_KompLib." "aadd2"
#   Addierer/Subtrahierer        Parameter:           (c) IERT  27.09.1995
#                                k1 .. Verstaerkung fuer u1 [1]
#                                k2 .. Verstaerkung fuer u2 [1]
#    y = k1*u1 + k2*u2
#
#
BLOCK AAdd2;
$ BLOCKDIM -1 -1 6 3
$ TEXT "Addierer"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 2
$ ICONALIG 1 1 1
INPUT
   u1 "[1] Addierereingang";
   u2 "[1] Addierereingang";
OUTPUT
   y  "[1] Addiererausgang";
PARAMETER
   k1 = 1 "[1] Verstaerkung";
   k2 = -1 "[1] Verstaerkung";
SIM
   y = k1*u1 + k2*u2;
ENDSIM
ENDBLOCK AAdd2;

FROM "Local" "laplace"
#  Block w0Laplace for ANA 2.x
#  G(s) = 1/(s*Ti)
#  generated by ANAlaplace Wizard 2.52
#  Wed Jan 20 09:09:38 2021
#
$ WIZARD Laplace "1/(s*Ti)"
BLOCK w0Laplace;
$ BLOCKDIM -1 -1 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] w0Laplace Eingang";
OUTPUT
   y "[1] w0Laplace Ausgang";
PARAMETER
   Ti = 1.0 "[?]";
STATE
   x1 "[1] w0Laplace";
VAR
   yp "derivate";
SIM
   x1 .= yp;
   yp  = 1./Ti*u;
   y   = x1;
ENDSIM
ENDBLOCK w0Laplace;

FROM "ANA1.x_KompLib." "acontrol"
#      Steuerungsblock           Parameter:           (c) IERT  28.09.1995
#   Abbruch nach fixer Zeit      te .. Simulationsdauer [s]
#  Datenpunkte im fixen          h  .. Kommunikationsinterval [s]
#  Kommunikationsinterval an
#       das AnaOszi              Hinweis:
#                                Durch schaltende Systeme oder zusaetzliche
#                                Steuerungsbloecke entstehen mitunter
#                                zusaetzliche Datenpunkte fuer das AnaOszi.
BLOCK AControl;
$ SUBTYPE CONTROL
$ BLOCKDIM -1 -1 6 5
$ TEXT ""
$ TEXTALIG 1 2 0 1
$ ICONNAME "control"
$ ICONDIM 2 2
$ ICONALIG 1 0 0
OUTPUT
   y "[1] Masse";
PARAMETER
   te = 10 "[s] Simulationsdauer";
   h= 0.01 "[s] Kommunikationsinterval";
SIM
   y = 0;
ENDSIM

PROCEDURE terminate;
   STORE;
   QUIT;
ENDPROCEDURE

PROCEDURE saver;
   SCHEDULE saver AT NOW+h;
   STORE;
ENDPROCEDURE

INIT
   SCHEDULE terminate AT te;
   SCHEDULE saver AT NOW;
ENDINIT
ENDBLOCK AControl;

FROM "Local" "w0laplace"
#  Block laplace for ANA 2.x
#  G(s) = kr*(1+s*Tn)/(s*Tn)
#  generated by ANAlaplace Wizard 2.52
#  Wed Jan 20 09:11:51 2021
#
$ WIZARD Laplace "kr*(1+s*Tn)/(s*Tn)"
BLOCK laplace;
$ BLOCKDIM -1 -1 8 5
$ TEXT "G(s) = kr*(1+s*T"
$      "n)/(s*Tn)"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] laplace Eingang";
OUTPUT
   y "[1] laplace Ausgang";
PARAMETER
   Tn = 1.0 "[?]";
   kr = 1.0 "[?]";
STATE
   x1 "[1] laplace";
SIM
   x1 .= kr/Tn*u;
   y   = x1 + kr*Tn/Tn*u;
ENDSIM
ENDBLOCK laplace;

FROM "Local" "w1laplace"
#  Block w0Laplace for ANA 2.x
#  G(s) = 1/(s*Ti)
#  generated by ANAlaplace Wizard 2.52
#  Wed Jan 20 09:09:38 2021
#
$ WIZARD Laplace "1/(s*Ti)"
BLOCK w0Laplace;
$ BLOCKDIM -1 -1 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] w0Laplace Eingang";
OUTPUT
   y "[1] w0Laplace Ausgang";
PARAMETER
   Ti = 1.0 "[?]";
STATE
   x1 "[1] w0Laplace";
VAR
   yp "derivate";
SIM
   x1 .= yp;
   yp  = 1./Ti*u;
   y   = x1;
ENDSIM
ENDBLOCK w0Laplace;

FROM "Local" "w2laplace"
#  Block w0Laplace for ANA 2.x
#  G(s) = 1/(s*Ti)
#  generated by ANAlaplace Wizard 2.52
#  Wed Jan 20 09:09:38 2021
#
$ WIZARD Laplace "1/(s*Ti)"
BLOCK w0Laplace;
$ BLOCKDIM -1 -1 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] w0Laplace Eingang";
OUTPUT
   y "[1] w0Laplace Ausgang";
PARAMETER
   Ti = 1.0 "[?]";
STATE
   x1 "[1] w0Laplace";
VAR
   yp "derivate";
SIM
   x1 .= yp;
   yp  = 1./Ti*u;
   y   = x1;
ENDSIM
ENDBLOCK w0Laplace;

FROM "Local" "w3laplace"
#  Block w0Laplace for ANA 2.x
#  G(s) = 1/(s*Ti)
#  generated by ANAlaplace Wizard 2.52
#  Wed Jan 20 09:09:38 2021
#
$ WIZARD Laplace "1/(s*Ti)"
BLOCK w0Laplace;
$ BLOCKDIM -1 -1 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] w0Laplace Eingang";
OUTPUT
   y "[1] w0Laplace Ausgang";
PARAMETER
   Ti = 1.0 "[?]";
STATE
   x1 "[1] w0Laplace";
VAR
   yp "derivate";
SIM
   x1 .= yp;
   yp  = 1./Ti*u;
   y   = x1;
ENDSIM
ENDBLOCK w0Laplace;

FROM "ANA1.x_KompLib." "apreg"
#    Proportionalregler          Parameter:           (c) IERT  07.10.1995
#        P-Regler                k  .. Verstaerkung [1]
#
#                                       y(s)
#    y(t) = k * u(t)             G(s) = ---- = k
#                                       u(s)
#
BLOCK APReg;
$ BLOCKDIM -1 -1 6 3
$ TEXT "P-Regler"
$ TEXTALIG 1 1 1 1
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
INPUT
   u "[1] P-Regler Eingang";
OUTPUT
   y "[1] P-Regler Ausgang";
PARAMETER
   k = 1.0 "[1] Verstaerkung";
SIM
   y = k * u;
ENDSIM
ENDBLOCK APReg;

/* END_PROLOG */


CIRCUIT GedGen; # Regler mit Integrator.ana
FROM "ANA1.x_KompLib."
USE asprung AS B_1 
$ BLOCKLIB ANA1.x_KompLib.
    A = 10;
    T = 0;
    A0 = 0;
$ BLOCKDIM 19 16 6 5
$ TEXT "Sprung"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 4
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_1"
$ ENDSIGNAMES
ENDUSE
FROM "ANA1.x_KompLib."
USE aadd2 AS B_2 
$ BLOCKLIB ANA1.x_KompLib.
    k1 = 1;
    k2 = -1;
$ BLOCKDIM 32 17 6 3
$ TEXT "Addierer"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_2"
$ ENDSIGNAMES
ENDUSE
FROM "Local"
USE laplace AS B_3 
$ BLOCKLIB Local
    Ti = 1.0;
$ BLOCKDIM 55 17 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 5 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_4"
$ ENDSIGNAMES
ENDUSE
FROM "ANA1.x_KompLib."
USE acontrol AS B_4 
$ BLOCKLIB ANA1.x_KompLib.
    te = 10;
    h = 0.01;
$ BLOCKDIM 41 4 6 5
$ TEXT ""
$ TEXTALIG 1 2 0 1 
$ ICONNAME "control"
$ ICONDIM 2 2
$ ICONALIG 1 0 0
$ SIGNAMES
$    "y_5"
$ ENDSIGNAMES
ENDUSE
FROM "Local"
USE w0laplace AS B_5 
$ BLOCKLIB Local
    Tn = 10;
    kr = 5;
$ BLOCKDIM 43 16 8 5
$ TEXT "G(s) = kr*(1+s*T"
$      "n)/(s*Tn)"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 6 4
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y"
$ ENDSIGNAMES
ENDUSE
FROM "ANA1.x_KompLib."
USE aadd2 AS B_6 
$ BLOCKLIB ANA1.x_KompLib.
    k1 = 1;
    k2 = -1;
$ BLOCKDIM 32 24 6 3
$ TEXT "Addierer"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_6"
$ ENDSIGNAMES
ENDUSE
FROM "Local"
USE w1laplace AS B_7 
$ BLOCKLIB Local
    Ti = 1.0;
$ BLOCKDIM 55 24 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 5 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_7"
$ ENDSIGNAMES
ENDUSE
FROM "ANA1.x_KompLib."
USE aadd2 AS B_8 
$ BLOCKLIB ANA1.x_KompLib.
    k1 = 1;
    k2 = -1;
$ BLOCKDIM 32 32 6 3
$ TEXT "Addierer"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_10"
$ ENDSIGNAMES
ENDUSE
FROM "Local"
USE w2laplace AS B_9 
$ BLOCKLIB Local
    Ti = 1.0;
$ BLOCKDIM 55 32 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 5 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_11"
$ ENDSIGNAMES
ENDUSE
FROM "Local"
USE w3laplace AS B_10 
$ BLOCKLIB Local
    Ti = 0.5;
$ BLOCKDIM 44 32 7 3
$ TEXT "G(s) = 1/(s*Ti)"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 5 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_12"
$ ENDSIGNAMES
ENDUSE
FROM "ANA1.x_KompLib."
USE apreg AS B_11 
$ BLOCKLIB ANA1.x_KompLib.
    k = 1.0;
$ BLOCKDIM 43 24 6 3
$ TEXT "P-Regler"
$ TEXTALIG 1 1 1 1 
$ ICONNAME "*** NO PIC ***"
$ ICONDIM 4 2
$ ICONALIG 1 1 1
$ SIGNAMES
$    "y_13"
$ ENDSIGNAMES
ENDUSE

CONNECT B_1.y TO B_2.u1;
$ INTERPOINTS
$ ENDINTERPOINTS
CONNECT B_3.y TO B_2.u2;
$ INTERPOINTS
$    30 19
$    30 22
$    64 22
$    64 18
$ ENDINTERPOINTS
CONNECT B_2.y TO B_5.u;
$ INTERPOINTS
$    42 18
$ ENDINTERPOINTS
CONNECT B_5.y TO B_3.u;
$ INTERPOINTS
$ ENDINTERPOINTS
CONNECT B_7.y TO B_6.u2;
$ INTERPOINTS
$    30 26
$    30 29
$    50 29
$    64 29
$    64 25
$ ENDINTERPOINTS
CONNECT B_1.y TO B_6.u1;
$ INTERPOINTS
$    27 24
$    27 18
$ ENDINTERPOINTS
CONNECT B_8.y TO B_10.u;
$ INTERPOINTS
$ ENDINTERPOINTS
CONNECT B_10.y TO B_9.u;
$ INTERPOINTS
$ ENDINTERPOINTS
CONNECT B_1.y TO B_8.u1;
$ INTERPOINTS
$    27 32
$    27 18
$ ENDINTERPOINTS
CONNECT B_9.y TO B_8.u2;
$ INTERPOINTS
$    30 34
$    30 37
$    64 37
$    64 33
$ ENDINTERPOINTS
CONNECT B_6.y TO B_11.u;
$ INTERPOINTS
$    42 25
$ ENDINTERPOINTS
CONNECT B_11.y TO B_7.u;
$ INTERPOINTS
$ ENDINTERPOINTS
SAVE  B_1.y B_3.y B_7.y B_9.y;

ENDCIRCUIT GedGen; # Regler mit Integrator.ana

/* BEGIN PARAMETER */
$ FNAME        nul
$ RMODE        0
$ HMODE        1
$ MODE         0
$ IALG         6
$ INITSTEP     0.1
$ MINSTEP      1.e-12
$ MAXSTEP      1.
$ ABSERR       1.e-6
$ RELERR       1.e-6
$ LIMIT        1.e-6
$ XVAR         0
$ OSZIXAUTO    1
$ OSZIYAUTO    1
$ OSZIXSCALE   1.
$ OSZIYSCALE   1.
$ OSZIXOFF     0.
$ OSZIYOFF     0.
/* END PARAMETER */
